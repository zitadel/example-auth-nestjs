<!--suppress HtmlDeprecatedAttribute -->
<html lang='en'>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>Zitadel PKCE Demo - Authenticated</title>
    <!--suppress JSUnresolvedLibraryURL -->
    <script src='https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4'></script>
    <link
      rel='icon'
      href='https://www.svgrepo.com/show/373872/nestjs.svg'
      type='image/svg+xml'
    />
  </head>
  <body class='bg-gray-50 min-h-screen flex flex-col'>
    <header class='bg-white border-b border-gray-200'>
      <div class='max-w-7xl mx-auto px-6 py-4'>
        <div class='flex items-center justify-between'>
          <div class='flex items-center space-x-3'>
            <img
              src='https://www.svgrepo.com/show/373872/nestjs.svg'
              alt='Express.js'
              class='w-8 h-8'
            />
            <h1 class='text-xl font-semibold text-gray-900'>Demo Application</h1>
          </div>
          <button
            onclick='handleLogout()'
            class='bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition duration-200 cursor-pointer'
          >
            Sign out
          </button>
        </div>
      </div>
    </header>
    <main class='flex-1 flex items-center justify-center px-6 py-12'>
      <div class='max-w-5xl mx-auto px-6 py-12'>
        <div
          class='bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6 mb-8'
        >
          <div class='flex items-center'>
            <div class='flex-shrink-0'>
              <div
                class='w-12 h-12 bg-green-500 rounded-full flex items-center justify-center'
              >
                <svg
                  class='w-6 h-6 text-white'
                  fill='currentColor'
                  viewBox='0 0 20 20'
                >
                  <path
                    fill-rule='evenodd'
                    d='M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z'
                    clip-rule='evenodd'
                  />
                </svg>
              </div>
            </div>
            <div class='ml-4'>
              <h2 class='text-xl font-semibold text-green-900'>Authentication
                Successful!</h2>
              <p class='text-green-700 mt-1'>You have successfully completed the
                PKCE authentication flow.</p>
            </div>
          </div>
        </div>
        <div class='bg-white rounded-lg border border-gray-200 p-8 mb-8'>
          <h1 class='text-3xl font-bold text-gray-900 mb-6'>üîê OAuth 2.0 PKCE
            Flow Completed</h1>

          <p class='text-lg text-gray-700 mb-8'>
            Congratulations! You have successfully completed the OAuth 2.0 PKCE
            (Proof Key for Code Exchange) authentication flow. This demonstrates
            how modern applications securely authenticate users with Zitadel.
          </p>

          <div class='grid md:grid-cols-2 gap-8 mb-8'>
            <div>
              <h2 class='text-xl font-semibold text-gray-900 mb-4'>What is PKCE?</h2>
              <p class='text-gray-700 mb-4'>
                PKCE is a security extension to OAuth 2.0 that protects against
                authorization code interception attacks. It's especially
                important for public clients like single-page applications and
                mobile apps.
              </p>

              <h3 class='text-lg font-semibold text-gray-900 mb-3'>Key Benefits:</h3>
              <ul class='space-y-2 text-gray-700'>
                <li class='flex items-center'>
                  <svg
                    class='w-4 h-4 text-green-500 mr-2'
                    fill='currentColor'
                    viewBox='0 0 20 20'
                  >
                    <path
                      fill-rule='evenodd'
                      d='M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z'
                      clip-rule='evenodd'
                    />
                  </svg>
                  No client secret required
                </li>
                <li class='flex items-center'>
                  <svg
                    class='w-4 h-4 text-green-500 mr-2'
                    fill='currentColor'
                    viewBox='0 0 20 20'
                  >
                    <path
                      fill-rule='evenodd'
                      d='M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z'
                      clip-rule='evenodd'
                    />
                  </svg>
                  Prevents code interception
                </li>
                <li class='flex items-center'>
                  <svg
                    class='w-4 h-4 text-green-500 mr-2'
                    fill='currentColor'
                    viewBox='0 0 20 20'
                  >
                    <path
                      fill-rule='evenodd'
                      d='M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z'
                      clip-rule='evenodd'
                    />
                  </svg>
                  Dynamic security per flow
                </li>
              </ul>
            </div>

            <div>
              <h2 class='text-xl font-semibold text-gray-900 mb-4'>Flow Steps
                Completed</h2>
              <div class='space-y-4'>
                <div class='flex items-center'>
                  <div
                    class='w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-semibold mr-3'
                  >
                    ‚úì
                  </div>
                  <div>
                    <div class='font-medium text-gray-900'>Code Verifier
                      Generated</div>
                    <div class='text-sm text-gray-600'>Random cryptographic
                      string created</div>
                  </div>
                </div>
                <div class='flex items-center'>
                  <div
                    class='w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-semibold mr-3'
                  >
                    ‚úì
                  </div>
                  <div>
                    <div class='font-medium text-gray-900'>Code Challenge
                      Created</div>
                    <div class='text-sm text-gray-600'>SHA256 hash of the
                      verifier</div>
                  </div>
                </div>
                <div class='flex items-center'>
                  <div
                    class='w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-semibold mr-3'
                  >
                    ‚úì
                  </div>
                  <div>
                    <div class='font-medium text-gray-900'>Authorization Request</div>
                    <div class='text-sm text-gray-600'>Redirected to Zitadel
                      with challenge</div>
                  </div>
                </div>
                <div class='flex items-center'>
                  <div
                    class='w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-semibold mr-3'
                  >
                    ‚úì
                  </div>
                  <div>
                    <div class='font-medium text-gray-900'>User Authentication</div>
                    <div class='text-sm text-gray-600'>Successfully
                      authenticated with Zitadel</div>
                  </div>
                </div>
                <div class='flex items-center'>
                  <div
                    class='w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-semibold mr-3'
                  >
                    ‚úì
                  </div>
                  <div>
                    <div class='font-medium text-gray-900'>Token Exchange</div>
                    <div class='text-sm text-gray-600'>Authorization code +
                      verifier exchanged for tokens
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class='bg-white rounded-lg border border-gray-200 p-8'>
          <h2 class='text-2xl font-semibold text-gray-900 mb-4'>Session
            Information</h2>
          <p class='text-gray-600 mb-6'>Below is the authentication data stored
            in your session after a successful PKCE flow:</p>

          <div class='bg-gray-900 rounded-lg p-6 overflow-x-auto'>
            <pre
              class='text-sm text-green-400 font-mono leading-relaxed'
              id='sessionData'
            >{{{userJson}}}</pre>
          </div>
        </div>
      </div>
    </main>
    <footer class='bg-gray-100 border-t border-gray-200'>
      <div class='max-w-7xl mx-auto px-6 py-6'>
        <div class='flex items-center justify-between'>
          <div class='flex items-center space-x-2'>
            <span class='text-sm text-gray-600'>Powered by</span>
            <img
              src='https://raw.githubusercontent.com/zitadel/zitadel-nextjs/868291c77ff37a56dcfea0378ddfea075dcdbc37/public/zitadel-logo-dark.svg'
              alt='Zitadel'
              class='h-12 w-auto'
            />
          </div>
          <div class='flex items-start max-w-2xl'>
            <div class='ml-3'>
              <p class='text-sm text-gray-600 text-right'>
                <strong class='text-gray-800'>Disclaimer:</strong>
                This is a demonstration application for reference purposes only.
                Do not use this code in production environments without proper
                security review and modifications.
              </p>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <script>
      function handleLogout() { window.location.href = '{{logoutUrl}}'; }
    </script>
  </body>
</html>